import{a as O}from"./axios-Mf404ijl.js";import{a5 as q,M as z,R as J,d as K,r as C,w as Q,a as k,b as D,f as x,g as w,E as s,F as A,e as S,u as X,h as U,q as G,t as H,B as Y,C as Z,_ as ee,j as ae,k as te,L as j}from"./_plugin-vue_export-helper-DsXqNseE.js";import{u as W,i as ne,B as le,a as B,j as se,K as L,c as re}from"./index-KAC86yf_.js";import{u as M,a as V,b as oe}from"./string-B2HKtvGE.js";import{t as ie}from"./toNumber-BrOljPEc.js";import"./index.es-E1oe2b8C.js";var ue=q,de=function(){return ue.Date.now()},ce=de,me=J,N=ce,F=ie,fe="Expected a function",ve=Math.max,ge=Math.min;function pe(u,i,m){var d,f,l,o,a,r,v=0,b=!1,g=!1,y=!0;if(typeof u!="function")throw new TypeError(fe);i=F(i)||0,me(m)&&(b=!!m.leading,g="maxWait"in m,l=g?ve(F(m.maxWait)||0,i):l,y="trailing"in m?!!m.trailing:y);function T(e){var h=d,$=f;return d=f=void 0,v=e,o=u.apply($,h),o}function E(e){return v=e,a=setTimeout(_,i),b?T(e):o}function I(e){var h=e-r,$=e-v,P=i-h;return g?ge(P,l-$):P}function R(e){var h=e-r,$=e-v;return r===void 0||h>=i||h<0||g&&$>=l}function _(){var e=N();if(R(e))return c(e);a=setTimeout(_,I(e))}function c(e){return a=void 0,y&&d?T(e):(d=f=void 0,o)}function n(){a!==void 0&&clearTimeout(a),v=0,d=r=f=a=void 0}function t(){return a===void 0?o:c(N())}function p(){var e=N(),h=R(e);if(d=arguments,f=this,r=e,h){if(a===void 0)return E(r);if(g)return clearTimeout(a),a=setTimeout(_,i),T(r)}return a===void 0&&(a=setTimeout(_,i)),o}return p.cancel=n,p.flush=t,p}var he=pe;const be=z(he),_e=u=>(Y("data-v-496ee694"),u=u(),Z(),u),ye={key:0,style:{"text-align":"center","margin-top":"8px"}},Ce={class:"search-results-layout"},ke=["href"],xe=_e(()=>S("div",{class:"bottom-margin text-center"},"Assign selected teams to...",-1)),Se={class:"assignment-button-layout"},Te=K({__name:"CentralTeamSearchDialog",setup(u){var R,_;const i=(R=nodecg.bundleConfig.central)==null?void 0:R.basePath,m=(_=nodecg.bundleConfig.central)==null?void 0:_.frontendPath,d=W(),f=M(),l=C(new Set),o=C(""),a=C(!1),r=C([]),v=C(0),b=C(0);let g=null;function y(c){d.addToTeamMapping(c,Array.from(l.value.values())),l.value=new Set}function T(c,n){c?l.value.add(n):l.value.delete(n)}async function E(c=!1){if(a.value||i==null||d.centralCredentials.token==null)return;if(ne(o.value)){r.value=[],a.value=!1;return}a.value=!0;let n=`${i}/search/teams?query=${encodeURIComponent(o.value)}`;c&&(n+=`&page=${b.value+1}&pagination_id=${g}`);try{const t=await O.get(n,{headers:{Authorization:`JWT ${d.centralCredentials.token}`}});g=t.data.pagination_id,c?(r.value.push(...t.data.results),b.value++):(l.value.forEach(p=>{t.data.results.some(e=>e.id===p)||l.value.delete(p)}),r.value=t.data.results,b.value=1),v.value=t.data.pages}finally{a.value=!1}}const I=be(E,500);return Q(o,()=>I()),(c,n)=>(k(),D(A,null,[x(s(B),{class:"search-box"},{default:w(()=>[x(s(le),{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=t=>o.value=t),loading:a.value,placeholder:"Search for a team...",name:"search-box",theme:"large",type:"search"},null,8,["modelValue","loading"])]),_:1}),r.value.length===0?(k(),D("div",ye," No results found... ")):(k(),D(A,{key:1},[S("div",Ce,[(k(!0),D(A,null,X(r.value,t=>(k(),U(s(B),{key:`search-result_${t.id}`},{default:w(()=>[S("div",null,[S("div",null,H(s(V)(t.name)),1),S("a",{href:`${s(m)}/teams/${t.id}`,target:"_blank"},"Open in Central",8,ke)]),x(s(se),{"model-value":l.value.has(t.id),label:"","onUpdate:modelValue":p=>T(p,t.id)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024))),128))]),b.value<v.value?(k(),U(s(L),{key:0,label:"Load more",async:"",style:{"max-width":"250px",margin:"0 auto"},onClick:n[1]||(n[1]=t=>E(!0))})):G("",!0),x(s(B),{class:"top-margin"},{default:w(()=>[xe,S("div",Se,[x(s(L),{label:s(V)(s(f).activeRound.teamA.name),disabled:l.value.size===0,onClick:n[2]||(n[2]=t=>y("a"))},null,8,["label","disabled"]),x(s(L),{label:s(V)(s(f).activeRound.teamB.name),disabled:l.value.size===0,onClick:n[3]||(n[3]=t=>y("b"))},null,8,["label","disabled"])])]),_:1})],64))],64))}}),Re=ee(Te,[["__scopeId","data-v-496ee694"]]);(async()=>{const u=ae(Re);u.use(te()),await j(re,W()),await j(oe,M()),u.mount("#app")})();
