import{a as O}from"./axios-Mf404ijl.js";import{d as q,r as C,w as z,a as k,b as D,f as x,g as w,E as r,F as A,e as S,u as J,h as U,q as K,t as Q,B as X,C as G,_ as H,j as Y,k as Z}from"./_plugin-vue_export-helper-Dg3X6I8a.js";import{t as ee,g as ae,a as te,s as j}from"./storeHelper-Dip-Ut0B.js";import{u as W,i as ne,B as le,a as B,j as re,K as V,c as se}from"./index-D6amFYoy.js";import{u as M,a as oe}from"./activeRoundStore-NyoUqykV.js";import{t as ie}from"./toNumber-Brt_E0mo.js";import{a as L}from"./string-BeBbVoVE.js";import"./index.es-DRRw5Fw1.js";var ue=ee,de=function(){return ue.Date.now()},ce=de,me=te,N=ce,F=ie,fe="Expected a function",ve=Math.max,pe=Math.min;function ge(u,i,m){var d,f,l,o,a,s,v=0,_=!1,p=!1,y=!0;if(typeof u!="function")throw new TypeError(fe);i=F(i)||0,me(m)&&(_=!!m.leading,p="maxWait"in m,l=p?ve(F(m.maxWait)||0,i):l,y="trailing"in m?!!m.trailing:y);function T(e){var h=d,$=f;return d=f=void 0,v=e,o=u.apply($,h),o}function E(e){return v=e,a=setTimeout(b,i),_?T(e):o}function I(e){var h=e-s,$=e-v,P=i-h;return p?pe(P,l-$):P}function R(e){var h=e-s,$=e-v;return s===void 0||h>=i||h<0||p&&$>=l}function b(){var e=N();if(R(e))return c(e);a=setTimeout(b,I(e))}function c(e){return a=void 0,y&&d?T(e):(d=f=void 0,o)}function n(){a!==void 0&&clearTimeout(a),v=0,d=s=f=a=void 0}function t(){return a===void 0?o:c(N())}function g(){var e=N(),h=R(e);if(d=arguments,f=this,s=e,h){if(a===void 0)return E(s);if(p)return clearTimeout(a),a=setTimeout(b,i),T(s)}return a===void 0&&(a=setTimeout(b,i)),o}return g.cancel=n,g.flush=t,g}var he=ge;const _e=ae(he),be=u=>(X("data-v-496ee694"),u=u(),G(),u),ye={key:0,style:{"text-align":"center","margin-top":"8px"}},Ce={class:"search-results-layout"},ke=["href"],xe=be(()=>S("div",{class:"bottom-margin text-center"},"Assign selected teams to...",-1)),Se={class:"assignment-button-layout"},Te=q({__name:"CentralTeamSearchDialog",setup(u){var R,b;const i=(R=nodecg.bundleConfig.central)==null?void 0:R.basePath,m=(b=nodecg.bundleConfig.central)==null?void 0:b.frontendPath,d=W(),f=M(),l=C(new Set),o=C(""),a=C(!1),s=C([]),v=C(0),_=C(0);let p=null;function y(c){d.addToTeamMapping(c,Array.from(l.value.values())),l.value=new Set}function T(c,n){c?l.value.add(n):l.value.delete(n)}async function E(c=!1){if(a.value||i==null||d.centralCredentials.token==null)return;if(ne(o.value)){s.value=[],a.value=!1;return}a.value=!0;let n=`${i}/search/teams?query=${encodeURIComponent(o.value)}`;c&&(n+=`&page=${_.value+1}&pagination_id=${p}`);try{const t=await O.get(n,{headers:{Authorization:`JWT ${d.centralCredentials.token}`}});p=t.data.pagination_id,c?(s.value.push(...t.data.results),_.value++):(l.value.forEach(g=>{t.data.results.some(e=>e.id===g)||l.value.delete(g)}),s.value=t.data.results,_.value=1),v.value=t.data.pages}finally{a.value=!1}}const I=_e(E,500);return z(o,()=>I()),(c,n)=>(k(),D(A,null,[x(r(B),{class:"search-box"},{default:w(()=>[x(r(le),{modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=t=>o.value=t),loading:a.value,placeholder:"Search for a team...",name:"search-box",theme:"large",type:"search"},null,8,["modelValue","loading"])]),_:1}),s.value.length===0?(k(),D("div",ye," No results found... ")):(k(),D(A,{key:1},[S("div",Ce,[(k(!0),D(A,null,J(s.value,t=>(k(),U(r(B),{key:`search-result_${t.id}`},{default:w(()=>[S("div",null,[S("div",null,Q(r(L)(t.name)),1),S("a",{href:`${r(m)}/teams/${t.id}`,target:"_blank"},"Open in Central",8,ke)]),x(r(re),{"model-value":l.value.has(t.id),label:"","onUpdate:modelValue":g=>T(g,t.id)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024))),128))]),_.value<v.value?(k(),U(r(V),{key:0,label:"Load more",async:"",style:{"max-width":"250px",margin:"0 auto"},onClick:n[1]||(n[1]=t=>E(!0))})):K("",!0),x(r(B),{class:"top-margin"},{default:w(()=>[xe,S("div",Se,[x(r(V),{label:r(L)(r(f).activeRound.teamA.name),disabled:l.value.size===0,onClick:n[2]||(n[2]=t=>y("a"))},null,8,["label","disabled"]),x(r(V),{label:r(L)(r(f).activeRound.teamB.name),disabled:l.value.size===0,onClick:n[3]||(n[3]=t=>y("b"))},null,8,["label","disabled"])])]),_:1})],64))],64))}}),Re=H(Te,[["__scopeId","data-v-496ee694"]]);(async()=>{const u=Y(Re);u.use(Z()),await j(se,W()),await j(oe,M()),u.mount("#app")})();
